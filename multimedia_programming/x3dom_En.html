<!DOCTYPE html>
<html>
<head>
	<meta charset=utf-8 />
	<meta name="description" content="Clara Peñalva's personal website" />
	<title>Clara Peñalva</title>
	<link rel="shortcut icon" href="../pics/favicon.png"/>
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<link rel="stylesheet" type="text/css"  media="only screen and (min-device-width: 500px)"  href="../style.css"/>
	<link rel="stylesheet" type="text/css" href="../style_resize.css"/>
	<link rel="stylesheet" type="text/css"  media="only screen and (max-device-width: 500px)"  href="../style_movil.css"/>
	<link rel ="stylesheet" type="text/css" href="../fonts.css"/>
	<script type="text/javascript" src="../js/AsideTop.js" language="javascript"> </script>
	<script type="text/javascript" src="../js/scrollUp.js" language="javascript"> </script>	
	
    <script type='text/javascript' src='http://www.x3dom.org/download/x3dom.js'></script>
    <link rel='stylesheet' type='text/css' href='http://www.x3dom.org/download/x3dom.css'/>
	<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js" ></script>
	<link rel='stylesheet' type='text/css' href='http://www.x3dom.org/download/x3dom.css'/>
	<script type="text/javascript" language="javascript"> 	
	//variables	
	var jugadorAct;
	var casillas;
	var ganado;
	var fin;
	var casillasOcupadas;
	
	//función de carga inicial
	function inicioPartida(){
		
		//se comprueba que esté todo rellenado
		if(document.getElementById("nameP1").value != "" && document.getElementById("nameP2").value != ""){			
			cambiarEstadoBotones(true);			
			document.getElementById("sendPartida").hidden = true;
			document.getElementById("sendFinPartida").hidden = false;
						
			jugadorAct = 1; //podrá ser 1 o 2
			casillas = [[false, 0], [false, 0], [false, 0], [false, 0], [false, 0], [false, 0], [false, 0], [false, 0], [false, 0]];
			ganado = false;
			fin = false;
			casillasOcupadas = 0;
						
			//se añade el listener de pulsación a todos los botones
			document.getElementById("ball1").addEventListener('click', jugada, true);
			document.getElementById("ball2").addEventListener('click', jugada, true);
			document.getElementById("ball3").addEventListener('click', jugada, true);
			document.getElementById("ball4").addEventListener('click', jugada, true);
			document.getElementById("ball5").addEventListener('click', jugada, true);
			document.getElementById("ball6").addEventListener('click', jugada, true);
			document.getElementById("ball7").addEventListener('click', jugada, true);
			document.getElementById("ball8").addEventListener('click', jugada, true);
			document.getElementById("ball9").addEventListener('click', jugada, true);
			
			//se muestra por pantalla quién está jugando
			var nomJugador = document.getElementById("nameP"+jugadorAct).value;
			document.getElementById("textInfo").string = nomJugador + "'s turn";
			resetBall(); //por si no es la primer partida			
		}
	}
	//reinicia los parámetros
	function finPartida(borrar){
		if(borrar){
			resetBall();
			//Se cambia el texto 	
			document.getElementById("textInfo").string = "Start game";
		}
		document.getElementById("ball1").removeEventListener('click', jugada, true);
		document.getElementById("ball2").removeEventListener('click', jugada, true);
		document.getElementById("ball3").removeEventListener('click', jugada, true);
		document.getElementById("ball4").removeEventListener('click', jugada, true);
		document.getElementById("ball5").removeEventListener('click', jugada, true);
		document.getElementById("ball6").removeEventListener('click', jugada, true);
		document.getElementById("ball7").removeEventListener('click', jugada, true);
		document.getElementById("ball8").removeEventListener('click', jugada, true);
		document.getElementById("ball9").removeEventListener('click', jugada, true);
		
		cambiarEstadoBotones(false);
		document.getElementById("sendFinPartida").hidden = true;
		document.getElementById("sendPartida").hidden = false;
	}
	
	function cambiarEstadoBotones(estado){
		document.getElementById('nameP1').disabled = estado;
		document.getElementById("nameP2").disabled = estado;
		document.getElementById("miColor1").disabled = estado;
		document.getElementById("miColor2").disabled = estado;
	}
	function resetBall(){
		//Se restauran todos los botones a gris
		document.getElementById("matBall1").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall2").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall3").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall4").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall5").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall6").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall7").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall8").setAttribute("diffuseColor", '0.7 0.7 0.7');
		document.getElementById("matBall9").setAttribute("diffuseColor", '0.7 0.7 0.7');
	}
		
	//Función a la que se llama cada vez que se pulsa el ratón
	function jugada(nodoTrans) {
		//se obtiene el número del id
		var casillaAct = parseInt(nodoTrans.hitObject.id.charAt(4)); 
		
		//pintar la nueva casilla
		var cambiada = rellenaCasilla(casillaAct);
		
		//si la casilla no estaba ocupada
		if(cambiada){
			if(ganado){ //si alguien ha ganado
				//se muestra por pantalla quién ha ganado
				var nomJugador = document.getElementById("nameP"+jugadorAct).value;
				document.getElementById("textInfo").string = nomJugador + " has won!";							
				finPartida(false);
			}
			else if(casillasOcupadas == 9){ //si ya no quedan huecos
				
				//texto de empate
				document.getElementById("textInfo").string = "There are no holes left, tie";	
				finPartida(false);
			}
			else{
				//se cambia de jugador en cada pulsación
				if (jugadorAct == 1) {
					jugadorAct = 2;
				}
				else {
					jugadorAct = 1;
				}
				//se muestra por pantalla quién está jugando
				var nomJugador = document.getElementById("nameP"+jugadorAct).value;
				document.getElementById("textInfo").string = nomJugador + "'s turn";
			}
		}
	}
	
	//Se elige la casilla sobre la que se ha pulsado
	function rellenaCasilla (casillaAct) {
	
		var cambiada = false; 
		if(casillas[casillaAct-1][0] == false) //si no está ocupada
		{
			if (jugadorAct == 1) {							
				casillas[casillaAct-1][0] = true; //ocupada
				casillas[casillaAct-1][1] = 1; //JUGADOR1
				pintaCasilla(casillaAct, 1);
				//se comprueba si ha ganado un jugador o si se ha acabado
				comprobarJugada(casillaAct, 1);
			} 
			else {
				casillas[casillaAct-1][0] = true; //ocupada
				casillas[casillaAct-1][1] = 2; //JUGADOR1
				pintaCasilla(casillaAct, 2);
				comprobarJugada(casillaAct, 2);
			}
			cambiada = true;
			casillasOcupadas++;
			document.getElementById('Timetitle').setAttribute('startTime',(new Date().getTime() / 1000).toString()); //Se inicia la animación
		}		
		return cambiada
	}
	
	//se pinta la casilla seleccionada
	function pintaCasilla(casillaAct, jugador){
		color = document.getElementById("miColor"+jugador).value; //se recoge el color del jugador
		document.getElementById("matBall"+casillaAct).setAttribute("diffuseColor", color);
	}
	
	function comprobarJugada(casAct, jugador){
		/*0 1 2
		  3 4 5
          6 7 8*/
		if(casillas[0][1]==jugador && casillas[1][1]==jugador && casillas[2][1]== jugador)
			ganado = true;
		else if(casillas[3][1]==jugador && casillas[4][1]==jugador && casillas[5][1]== jugador)
			ganado = true;
		else if (casillas[6][1]== jugador && casillas[7][1]== jugador && casillas[8][1]== jugador)
			ganado = true;
		else if(casillas[0][1]==jugador && casillas[3][1]==jugador && casillas[6][1]== jugador)	
			ganado = true;
		else if (casillas[1][1]== jugador && casillas[4][1]== jugador && casillas[7][1]== jugador)
			ganado = true;
		else if(casillas[2][1]==jugador && casillas[5][1]==jugador && casillas[8][1]== jugador)	
			ganado = true;
		else if(casillas[0][1]==jugador && casillas[4][1]==jugador && casillas[8][1]== jugador)	
			ganado = true;	
		else if(casillas[2][1]==jugador && casillas[4][1]==jugador && casillas[6][1]== jugador)	
			ganado = true;	
	}
	</script>
</head>
  
<body>		
	<header id="menu" class="menu">
    	<div id="logo" class="logo"> 
			<a href="../indexEn.html"><img src="../pics/logo.png" alt="Logo"></a>
		</div>
		<div class="idiomas"> 
			<a href="../programacion_multimedia/x3dom.html">Castellano</a>
		</div>
		<section>	 
			<nav id="menuPrinc">
				<ul class="children"> 
					<li><a href="../indexEn.html"><span class="icon-home3"></span>Introduction</a></li>
					<li class="submenu">
						<a href="#"><span class="icon-profile"></span>Portfolio<span class="caret icon-arrow-down2" ></span></a>
						<ul class="children">
							<li><a href="../video_game_development.html">Video Game Development</a></li>
							<li><a href="../advanced_animation.html">Advanced Animation Techniques</a></li>
							<li><a href="../animation.html">Computer Animation</a></li>
							<li><a href="../simulation.html">Computer Simulation </a></li>
							<li><a href="../multimedia_programming.html">Multimedia Programming</a></li>
						</ul>
					</li>
				</ul>
			</nav>
		</section>	
    </header>
	
	<aside class="vertical" id="verticalGeneral">
		<ul>
			<li id="TitleMenuAside">Portfolio</li>
			<li><a href="audio_En.html">Audio</a></li>
			<li><a href="canvas_En.html">Canvas</a></li>		
			<li><a href="x3dom_En.html">X3DOM</a></li>		
			<li><a href="threejs_En.html">Threejs</a></li>	
			<li><a href="d3js_En.html">D3js</a></li>	
		</ul>
	</aside>
			
	<main id="cuerpo" class="cuerpo">
    	<h1>Multimedia programming</h1>
    	<h2>X3DOM: TIC-TAC-TOE</h2>
		<div id="juego">
			<div id="playersbox">
				
				<p><b>Name of the players</b></p>
				<span class="icon-user"></span>
				<input type="text" class="namePlayer"  id="nameP1" placeholder="Name of player 1 " /> <br/>
				
				<span class="icon-user"></span>
				<input type="text" class="namePlayer"  id="nameP2" placeholder="Name of player 2"/> <br/>
		
				<hr/> 

				<input type="color" id="miColor1" name="miColor1" value="#FFCBC0"/> Color of player 1<br/>
				<input type="color" id="miColor2" name="miColor2" value="#6AAECD"/> Color of player 2<br/>
			
				<input type="submit" id="sendPartida"  value="Start game" onclick="inicioPartida()"/> <br/>
				<input type="submit" id="sendFinPartida"  value="Finish game" onclick="finPartida(true)" hidden="true"/> <br/>
			</div>
			
			<div id="tablerobox">
				<x3d width="450" height="450" style="border: 2px solid gray; border-radius: 10px; box-shadow: 0px 5px 10px #B5C1C5;">
					<scene>
						<Viewpoint position="0.0 0.0 -34.0" orientation="0.00000 1.00000 0.00000 3.141516" ></Viewpoint>
						<directionalLight location='5 0 -20' direction="-0.7,0,2" intensity='0.5' shadowIntensity='0.4' shadowOffset="0.7"></directionalLight>
											
						<transform id="tablero" translation="0 0.0 1.5" rotation="0.0 180.0 0.0 3.141516">
							<shape render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									
									<ImageTexture url="../pics/prom/x3dom/fondoX3DOM.jpg"></ImageTexture>
								</appearance>
								<plane DEF="sphere" solid="true" size="30 30" />			
							</shape>
						</transform>	
						
						<transform DEF="transTitle" translation="0 10 0.5" rotation="0 1 0 3.14">
							<shape>
								<appearance>
									<material ambientIntensity='0.0933' diffuseColor='0.2 0.2 0.2' shininess='0.51' specularColor='0.01 0.01 0.01'></material>
								</appearance>
								<text id="textTitle"  string='"TIC-TAC-TOE"' solid='false'>
									<fontstyle family="TYPEWRITER" style="BOLD" size="3" justify='middle' quality='1'></fontstyle>
								</text>
							</shape>
						</transform>
						
						<!--Se establece la rotación-->
						<timeSensor id="Timetitle" >
						</timeSensor>
						<orientationInterpolator id="rotationTitle" key="0.0 0.5 1.0" keyValue="0 1 0 3.14, 0 1 0 6.28, 0 1 0 9.42">
						</orientationInterpolator>
						<ROUTE fromNode='Timetitle' fromField='fraction_changed' toNode='rotationTitle' toField='set_fraction'></ROUTE>
						<ROUTE fromNode='rotationTitle' fromField='value_changed' toNode='transTitle' toField='set_rotation'></ROUTE>
						
												
						<transform translation="0 -12 1" rotation="0 1 0 3.14">
							<shape>
								<appearance>
									<material ambientIntensity='0.0933' diffuseColor='0.2 0.2 0.2' shininess='0.51' specularColor='0.01 0.01 0.01'></material>
								</appearance>
								<text id="textInfo" string="Start game" solid='false'>
									<fontstyle family="TYPEWRITER" style="BOLDITALIC" size="1.5" justify='middle' quality='1'></fontstyle>
								</text>
							</shape>
						</transform>
						
						<transform  rotation="0.5 1 0 0"  translation="5 5 0" scale="1.5 1.5 1.5">
							<shape id="ball1" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall1' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="0 5 0" scale="1.5 1.5 1.5">
							<shape id="ball2" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall2' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="-5 5 0" scale="1.5 1.5 1.5">
							<shape id="ball3" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall3' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="5 0 0" scale="1.5 1.5 1.5">
							<shape id="ball4" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall4' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="0 0 0" scale="1.5 1.5 1.5">
							<shape id="ball5" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall5' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="-5 0 0" scale="1.5 1.5 1.5">
							<shape id="ball6" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall6' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="5 -5 0" scale="1.5 1.5 1.5">
							<shape id="ball7" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall7' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="0 -5 0" scale="1.5 1.5 1.5">
							<shape id="ball8" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall8' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
						<transform rotation="0.5 1 0 0" translation="-5 -5 0" scale="1.5 1.5 1.5">
							<shape id="ball9" render="true" bboxCenter="0,0,0" bboxSize="-1,-1,-1" isPickable="true">					
								<appearance sortType="auto" alphaClipThreshold="0.1">
									<material id='matBall9' diffuseColor="0.7 0.7 0.7" specularColor="0.2 0.2 0.2" shininess="0.145" ambientIntensity="0.2" emissiveColor="0,0,0"/>
								</appearance>
								<sphere DEF="sphere" solid="true" radius="1" subdivision="24,24" />			
							</shape>
						</transform>
					</scene>
				</x3d>
			</div>
		</div>
		<div>
			<p> Press "r" to restore the original board view. </p>
		</div>
		<span class="ir-arriba icon-arrow-up2"></span>				
		<br/><br/><br/><br/><br/><br/> 
		<footer id="footercontainer">
			<div id="authors"> Clara Peñalva Carbonell
				<div id="socialFooter">
					<a href="https://www.youtube.com/channel/UCPH4xYbSNIHqG4LUHQTgQAw" target="_blank"><span class="icon-youtube4"></span> </a>
					<a href="https://es.linkedin.com/in/clara-penalva" target="_blank"><span class="icon-linkedin"></span> </a>
				</div>
			</div>
		</footer> 
	</main>
</body>
</html>
